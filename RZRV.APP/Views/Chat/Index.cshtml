@using RZRV.APP.ViewModels
@model ChatViewModel
@{
    var test = Model;
}
<div class="custom-tab-1">
    <ul class="nav nav-tabs">
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#notes">یادداشت</a></li>
        <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#alerts">هشدارها</a></li>
        <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#chat">چت کردن</a></li>
    </ul>
    <div class="tab-content">
        <div class="tab-pane fade active show" id="chat" role="tabpanel">
            <div class="card mb-sm-3 mb-md-0 contacts_card dz-chat-user-box">
                <div class="card-header chat-list-header text-center">
                    <a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewbox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect fill="#000000" x="4" y="11" width="16" height="2" rx="1"></rect><rect fill="#000000" opacity="0.3" transform="translate(12.000000, 12.000000) rotate(-270.000000) translate(-12.000000, -12.000000) " x="4" y="11" width="16" height="2" rx="1"></rect></g></svg></a><div>
                        <h6 class="mb-1">لیست چت</h6>
                        <p class="mb-0">نمایش همه</p>
                    </div>
                    <a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewbox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"></rect><circle fill="#000000" cx="5" cy="12" r="2"></circle><circle fill="#000000" cx="12" cy="12" r="2"></circle><circle fill="#000000" cx="19" cy="12" r="2"></circle></g></svg></a>
                </div>
                <div class="card-body contacts_body p-0 dz-scroll " id="DZ_W_Contacts_Body">
                    <ul class="contacts">
                        <li class="name-first-letter">آ</li>
                        <li class="active dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/1.jpg" class="rounded-circle user_img" alt=""><span class="online_icon"></span>
                                </div>
                                <div class="user_info">
                                    <span>آرچی پارکر</span><p>Kalid آنلاین است</p>
                                </div>
                            </div>
                        </li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/2.jpg" class="rounded-circle user_img" alt=""><span class="online_icon offline"></span>
                                </div>
                                <div class="user_info">
                                    <span>آلفی میسون</span><p>طاهره 7 دقیقه پیش رفت</p>
                                </div>
                            </div>
                        </li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/3.jpg" class="rounded-circle user_img" alt=""><span class="online_icon"></span>
                                </div>
                                <div class="user_info">
                                    <span>آهارلی کین</span><p>سامی آنلاین است</p>
                                </div>
                            </div>
                        </li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/4.jpg" class="rounded-circle user_img" alt=""><span class="online_icon offline"></span>
                                </div>
                                <div class="user_info">
                                    <span>آتان جاکوبی</span><p>نرگس 30 دقیقه پیش رفت</p>
                                </div>
                            </div>
                        </li>
                        <li class="name-first-letter">ب</li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/5.jpg" class="rounded-circle user_img" alt=""><span class="online_icon offline"></span>
                                </div>
                                <div class="user_info">
                                    <span>بشید صمیم</span><p>رشید 50 دقیقه پیش رفت</p>
                                </div>
                            </div>
                        </li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/1.jpg" class="rounded-circle user_img" alt=""><span class="online_icon"></span>
                                </div>
                                <div class="user_info">
                                    <span>بردی رونان</span><p>Kalid آنلاین است</p>
                                </div>
                            </div>
                        </li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/2.jpg" class="rounded-circle user_img" alt=""><span class="online_icon offline"></span>
                                </div>
                                <div class="user_info">
                                    <span>جورج کارسون</span><p>طاهره 7 دقیقه پیش رفت</p>
                                </div>
                            </div>
                        </li>
                        <li class="name-first-letter">آقای</li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/3.jpg" class="rounded-circle user_img" alt=""><span class="online_icon"></span>
                                </div>
                                <div class="user_info">
                                    <span>دری پارکر</span><p>سامی آنلاین است</p>
                                </div>
                            </div>
                        </li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/4.jpg" class="rounded-circle user_img" alt=""><span class="online_icon offline"></span>
                                </div>
                                <div class="user_info">
                                    <span>دنری هانتر</span><p>نرگس 30 دقیقه پیش رفت</p>
                                </div>
                            </div>
                        </li>
                        <li class="name-first-letter">جی</li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/5.jpg" class="rounded-circle user_img" alt=""><span class="online_icon offline"></span>
                                </div>
                                <div class="user_info">
                                    <span>جک رونان</span><p>رشید 50 دقیقه پیش رفت</p>
                                </div>
                            </div>
                        </li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/1.jpg" class="rounded-circle user_img" alt=""><span class="online_icon"></span>
                                </div>
                                <div class="user_info">
                                    <span>جیکوب تاکر</span><p>Kalid آنلاین است</p>
                                </div>
                            </div>
                        </li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/2.jpg" class="rounded-circle user_img" alt=""><span class="online_icon offline"></span>
                                </div>
                                <div class="user_info">
                                    <span>جیمز لوگان</span><p>طاهره 7 دقیقه پیش رفت</p>
                                </div>
                            </div>
                        </li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/3.jpg" class="rounded-circle user_img" alt=""><span class="online_icon"></span>
                                </div>
                                <div class="user_info">
                                    <span>جاشوا وستون</span><p>سامی آنلاین است</p>
                                </div>
                            </div>
                        </li>
                        <li class="name-first-letter">اوه</li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/4.jpg" class="rounded-circle user_img" alt=""><span class="online_icon offline"></span>
                                </div>
                                <div class="user_info">
                                    <span>الیور آکر</span><p>نرگس 30 دقیقه پیش رفت</p>
                                </div>
                            </div>
                        </li>
                        <li class="dz-chat-user">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont">
                                    <img src="images/avatar/5.jpg" class="rounded-circle user_img" alt=""><span class="online_icon offline"></span>
                                </div>
                                <div class="user_info">
                                    <span>اسکار وستون</span><p>رشید 50 دقیقه پیش رفت</p>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="card chat dz-chat-history-box d-none">
                <div class="card-header chat-list-header text-center">
                    <a href="javascript:void(0);" class="dz-chat-history-back"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewbox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon points="0 0 24 0 24 24 0 24"></polygon><rect fill="#000000" opacity="0.3" transform="translate(15.000000, 12.000000) scale(-1, 1) rotate(-90.000000) translate(-15.000000, -12.000000) " x="14" y="7" width="2" height="10" rx="1"></rect><path d="M3.7071045,15.7071045 C3.3165802,16.0976288 2.68341522,16.0976288 2.29289093,15.7071045 C1.90236664,15.3165802 1.90236664,14.6834152 2.29289093,14.2928909 L8.29289093,8.29289093 C8.67146987,7.914312 9.28105631,7.90106637 9.67572234,8.26284357 L15.6757223,13.7628436 C16.0828413,14.136036 16.1103443,14.7686034 15.7371519,15.1757223 C15.3639594,15.5828413 14.7313921,15.6103443 14.3242731,15.2371519 L9.03007346,10.3841355 L3.7071045,15.7071045 Z" fill="#000000" fill-rule="nonzero" transform="translate(9.000001, 11.999997) scale(-1, -1) rotate(90.000000) translate(-9.000001, -11.999997) "></path></g></svg></a><div>
                        <h6 class="mb-1">چت با خیلش</h6>
                        <p class="mb-0 text-success">برخط</p>
                    </div>
                    <div class="dropdown">
                        <a href="javascript:void(0);" data-bs-toggle="dropdown" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewbox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"></rect><circle fill="#000000" cx="5" cy="12" r="2"></circle><circle fill="#000000" cx="12" cy="12" r="2"></circle><circle fill="#000000" cx="19" cy="12" r="2"></circle></g></svg></a><ul class="dropdown-menu dropdown-menu-end">
                            <li class="dropdown-item">
                                <i class="fa fa-user-circle text-primary me-2"></i>مشاهده نمایه
                            </li>
                            <li class="dropdown-item">
                                <i class="fa fa-users text-primary me-2"></i>به دوستان btn-close اضافه کنید
                            </li>
                            <li class="dropdown-item">
                                <i class="fa fa-plus text-primary me-2"></i>به گروه اضافه کنید
                            </li>
                            <li class="dropdown-item">
                                <i class="fa fa-ban text-primary me-2"></i>مسدود کردن
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="card-body msg_card_body dz-scroll" id="DZ_W_Contacts_Body3">
                    <div class="d-flex justify-content-start mb-4">
                        <div class="img_cont_msg"><img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt=""></div>
                        <div class="msg_cotainer">
                            سلام. چطوری؟<span class="msg_time">ساعت 8:40 صبح امروز</span>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mb-4">
                        <div class="msg_cotainer_send">
                            سلام خالد من خوبم tnx شما چطور؟<span class="msg_time_send">8:55 صبح امروز</span>
                        </div>
                        <div class="img_cont_msg"><img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt=""></div>
                    </div>
                    <div class="d-flex justify-content-start mb-4">
                        <div class="img_cont_msg"><img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt=""></div>
                        <div class="msg_cotainer">
                            من هم خوبم ممنون از قالب چتتون<span class="msg_time">9:00 صبح امروز</span>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mb-4">
                        <div class="msg_cotainer_send">
                            خواهش میکنم<span class="msg_time_send">9:05 صبح امروز</span>
                        </div>
                        <div class="img_cont_msg"><img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt=""></div>
                    </div>
                    <div class="d-flex justify-content-start mb-4">
                        <div class="img_cont_msg"><img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt=""></div>
                        <div class="msg_cotainer">
                            من دنبال الگوی بعدی شما هستم<span class="msg_time">9:07 صبح امروز</span>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mb-4">
                        <div class="msg_cotainer_send">
                            باشه ممنون روز خوبی داشته باشی<span class="msg_time_send">ساعت 9:10 صبح امروز</span>
                        </div>
                        <div class="img_cont_msg"><img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt=""></div>
                    </div>
                    <div class="d-flex justify-content-start mb-4">
                        <div class="img_cont_msg"><img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt=""></div>
                        <div class="msg_cotainer">
                            خداحافظ، می بینمت<span class="msg_time">9:12 صبح امروز</span>
                        </div>
                    </div>
                    <div class="d-flex justify-content-start mb-4">
                        <div class="img_cont_msg"><img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt=""></div>
                        <div class="msg_cotainer">
                            سلام. چطوری؟<span class="msg_time">ساعت 8:40 صبح امروز</span>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mb-4">
                        <div class="msg_cotainer_send">
                            سلام خالد من خوبم tnx شما چطور؟<span class="msg_time_send">8:55 صبح امروز</span>
                        </div>
                        <div class="img_cont_msg"><img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt=""></div>
                    </div>
                    <div class="d-flex justify-content-start mb-4">
                        <div class="img_cont_msg"><img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt=""></div>
                        <div class="msg_cotainer">
                            من هم خوبم ممنون از قالب چتتون<span class="msg_time">9:00 صبح امروز</span>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mb-4">
                        <div class="msg_cotainer_send">
                            خواهش میکنم<span class="msg_time_send">9:05 صبح امروز</span>
                        </div>
                        <div class="img_cont_msg"><img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt=""></div>
                    </div>
                    <div class="d-flex justify-content-start mb-4">
                        <div class="img_cont_msg"><img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt=""></div>
                        <div class="msg_cotainer">
                            من دنبال الگوی بعدی شما هستم<span class="msg_time">9:07 صبح امروز</span>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mb-4">
                        <div class="msg_cotainer_send">
                            باشه ممنون روز خوبی داشته باشی<span class="msg_time_send">ساعت 9:10 صبح امروز</span>
                        </div>
                        <div class="img_cont_msg"><img src="images/avatar/2.jpg" class="rounded-circle user_img_msg" alt=""></div>
                    </div>
                    <div class="d-flex justify-content-start mb-4">
                        <div class="img_cont_msg"><img src="images/avatar/1.jpg" class="rounded-circle user_img_msg" alt=""></div>
                        <div class="msg_cotainer">
                            خداحافظ، می بینمت<span class="msg_time">9:12 صبح امروز</span>
                        </div>
                    </div>
                </div>
                <div class="card-footer type_msg">
                    <div class="input-group">
<textarea class="form-control" placeholder="پیام خود را تایپ کنید..."></textarea><div class="input-group-append"><button type="button" class="btn btn-primary"><i class="fa fa-location-arrow"></i></button></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane fade" id="alerts" role="tabpanel">
            <div class="card mb-sm-3 mb-md-0 contacts_card">
                <div class="card-header chat-list-header text-center">
                    <a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewbox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"></rect><circle fill="#000000" cx="5" cy="12" r="2"></circle><circle fill="#000000" cx="12" cy="12" r="2"></circle><circle fill="#000000" cx="19" cy="12" r="2"></circle></g></svg></a><div>
                        <h6 class="mb-1">اطلاعیه ها</h6>
                        <p class="mb-0">نمایش همه</p>
                    </div>
                    <a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewbox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"></rect><path d="M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"></path><path d="M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z" fill="#000000" fill-rule="nonzero"></path></g></svg></a>
                </div>
                <div class="card-body contacts_body p-0 dz-scroll" id="DZ_W_Contacts_Body1">
                    <ul class="contacts">
                        <li class="name-first-letter">وضعیت شدید</li>
                        <li class="active">
                            <div class="d-flex bd-highlight">
                                <div class="img_cont primary">KK</div>
                                <div class="user_info">
                                    <span>تولد دیوید نستر</span><p class="text-primary">امروز</p>
                                </div>
                            </div>
                        </li>
                        <li class="name-first-letter">اجتماعی</li>
                        <li>
                            <div class="d-flex bd-highlight">
                                <div class="img_cont success">RU</div>
                                <div class="user_info">
                                    <span>کمال ساده شده</span><p>جیم اسمیت در مورد وضعیت شما نظر داد</p>
                                </div>
                            </div>
                        </li>
                        <li class="name-first-letter">وضعیت شدید</li>
                        <li>
                            <div class="d-flex bd-highlight">
                                <div class="img_cont primary">AU</div>
                                <div class="user_info">
                                    <span>آهارلی کین</span><p>سامی آنلاین است</p>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="d-flex bd-highlight">
                                <div class="img_cont info">MO</div>
                                <div class="user_info">
                                    <span>آتان جاکوبی</span><p>نرگس 30 دقیقه پیش رفت</p>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="card-footer"></div>
            </div>
        </div>
        <div class="tab-pane fade" id="notes">
            <div class="card mb-sm-3 mb-md-0 note_card">
                <div class="card-header chat-list-header text-center">
                    <a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewbox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect fill="#000000" x="4" y="11" width="16" height="2" rx="1"></rect><rect fill="#000000" opacity="0.3" transform="translate(12.000000, 12.000000) rotate(-270.000000) translate(-12.000000, -12.000000) " x="4" y="11" width="16" height="2" rx="1"></rect></g></svg></a><div>
                        <h6 class="mb-1">یادداشت</h6>
                        <p class="mb-0">یادداشت های جدید اضافه کنید</p>
                    </div>
                    <a href="javascript:void(0);"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18px" height="18px" viewbox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"></rect><path d="M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"></path><path d="M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z" fill="#000000" fill-rule="nonzero"></path></g></svg></a>
                </div>
                <div class="card-body contacts_body p-0 dz-scroll" id="DZ_W_Contacts_Body2">
                    <ul class="contacts">
                        <li class="active">
                            <div class="d-flex bd-highlight">
                                <div class="user_info">
                                    <span>سفارش جدید ثبت شد..</span><p>10 اوت 2020</p>
                                </div>
                                <div class="ms-auto">
                                    <a href="javascript:void(0);" class="btn btn-primary btn-xs sharp me-1"><i class="fa fa-pencil"></i></a><a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i class="fa fa-trash"></i></a>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="d-flex bd-highlight">
                                <div class="user_info">
                                    <span>یوتیوب، یک وب سایت اشتراک گذاری ویدیو..</span><p>10 اوت 2020</p>
                                </div>
                                <div class="ms-auto">
                                    <a href="javascript:void(0);" class="btn btn-primary btn-xs sharp me-1"><i class="fa fa-pencil"></i></a><a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i class="fa fa-trash"></i></a>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="d-flex bd-highlight">
                                <div class="user_info">
                                    <span>جان فقط محصولت را بخر..</span><p>10 اوت 2020</p>
                                </div>
                                <div class="ms-auto">
                                    <a href="javascript:void(0);" class="btn btn-primary btn-xs sharp me-1"><i class="fa fa-pencil"></i></a><a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i class="fa fa-trash"></i></a>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="d-flex bd-highlight">
                                <div class="user_info">
                                    <span>آتان جاکوبی</span><p>10 اوت 2020</p>
                                </div>
                                <div class="ms-auto">
                                    <a href="javascript:void(0);" class="btn btn-primary btn-xs sharp me-1"><i class="fa fa-pencil"></i></a><a href="javascript:void(0);" class="btn btn-danger btn-xs sharp"><i class="fa fa-trash"></i></a>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

@* <div class="container">
    <div class="row">
        <!-- Users List -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5>Users</h5>
                </div>
                <div class="card-body users-list">
                    @foreach (var user in Model.Users.Where(u => u.Id != Model.CurrentUserId))
                    {
                        <div class="user-item d-flex align-items-center p-2" onclick="selectUser('@user.Id', '@user.UserName')">
                            <img src="@Url.Action("GetAvatar", "User", new { fileName = user.AvatarPath })" class="rounded-circle mr-2" style="width: 40px; height: 40px;" />
                            <div>
                                <h6 class="mb-0">@user.UserName</h6>
                                <small class="text-muted">@(Model.UserStatuses?.GetValueOrDefault(user.Id, "Offline"))</small>
                            </div>
                            @if (Model.UnreadMessageCounts?.GetValueOrDefault(user.Id, 0) > 0)
                            {
                                <span class="badge badge-primary ml-auto">@Model.UnreadMessageCounts[user.Id]</span>
                            }
                        </div>
                    }
                </div>
            </div>
        </div>

        <!-- Chat Area -->
        <div class="col-md-8">
            <div class="card">
                <div class="card-header" id="selectedUserHeader">
                    <h5>Select a user to start chatting</h5>
                </div>
                <div class="card-body chat-messages" id="messagesList">
                    <!-- Messages will be loaded here -->
                </div>
                <div class="card-footer">
                    <div class="input-group">
                        <input type="text" id="messageInput" class="form-control" placeholder="Type your message..." />
                        <div class="input-group-append">
                            <button class="btn btn-primary" onclick="sendMessage()">Send</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> *@

@section Scripts {
    <script src="~/lib/microsoft/signalr/dist/browser/signalr.js"></script>
    <script>
        let selectedUserId = '';
        let selectedUserName = '';
        const currentUserId = '@Model.CurrentUserId';

        const connection = new signalR.HubConnectionBuilder()
            .withUrl("/chatHub")
            .build();

        function formatDateTime(dateString) {
            const d = new Date(dateString);
            const options = {
                hour: '2-digit',
                minute: '2-digit',
                hour12: false
            };
            return d.toLocaleString('fa-IR', options);
        }

        connection.on("ReceiveMessage", (message) => {
            appendMessage(message);
        });

        function selectUser(userId, userName) {
            selectedUserId = userId;
            selectedUserName = userName;
            document.getElementById("selectedUserHeader").innerHTML = `<h5>Chat with ${userName}</h5>`;
            loadMessages(userId);
        }

        function appendMessage(message) {
            const messagesList = document.getElementById("messagesList");
            const messageDiv = document.createElement("div");
            const localTime = formatDateTime(message.createdAt);

            messageDiv.className = `message-wrapper ${message.senderId === currentUserId ? 'sent' : 'received'}`;
            messageDiv.innerHTML = `
                <div class="message">
                    <div class="message-content">${message.content}</div>
                            <div class="message-time">${localTime}</div>
                </div>
            `;

            messagesList.appendChild(messageDiv);
            messagesList.scrollTop = messagesList.scrollHeight;
        }

        async function sendMessage() {
            const messageInput = document.getElementById("messageInput");
            const message = messageInput.value;

            if (message && selectedUserId) {
                await connection.invoke("SendMessage", selectedUserId, message);
                messageInput.value = '';
            }
        }

        async function loadMessages(userId) {
            const response = await fetch(`/Chat/GetMessages?userId=${userId}`);
            const messages = await response.json();

            const messagesList = document.getElementById("messagesList");
            messagesList.innerHTML = '';

            messages.map(msg => {
                appendMessage(msg);
            });
        }

        connection.start();
    </script>
}

<style>
    .users-list {
        height: 600px;
        overflow-y: auto;
    }

    .chat-messages {
        height: 500px;
        overflow-y: auto;
    }

    .message {
        max-width: 70%;
        border-radius: 10px;
        margin: 5px;
    }

    .sent {
        background-color: #007bff;
        color: white;
        margin-left: auto;
    }

    .received {
        background-color: #f8f9fa;
        margin-right: auto;
    }

    .user-item {
        cursor: pointer;
        transition: background-color 0.3s;
    }

        .user-item:hover {
            background-color: #f8f9fa;
        }
</style>